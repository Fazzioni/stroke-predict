<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> </title>
  <link rel="stylesheet" href="teste.css">
  <link rel="stylesheet" href="fundo.css">
</head>
<body>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>

  <script>
    let model_heart;
    let test_tensor;

    async function Start(){
        // carregar o modelo salvo
        model_heart = await tf.loadLayersModel('/model/model.json');
 
        // habilitar o botao, apos carregar

        test_tensor = tf.tensor2d([[1,0.49,0,0,0,0,0.474408,0.344, 1, 0, 0,0]]);

        console.log(  model_heart.predict(test_tensor).print()  );
    }
    Start()



  </script>

    <header>
    
      <h1>Predição</h1>
      <h1>Informações</h1>
      <h1>Sobre</h1>

   </header>
    <!-- coração no canto esquerdo -->
    <div class="box"> <div class="heart">   </div> </div>

         <!-- animação atrás  -->
        <div class="bloods" ></div>

          <!-- Formulário de predição-->
          <div class="form">
                <h1>...</h1>

                <!-- Genero -->
                <h2>Qual seu gênero?</h2>
                <input class="red" type="radio" name="radio_geneo" id="radio_geneo_w" value="w"  >
                <label for="radio_geneo_w">Mulher</label>
                <input class="red" type="radio" name="radio_geneo" id="radio_geneo_m" value="m"  >
                <label for="radio_geneo_m">Homem</label>


                <!-- age -->
                <h2>Quantos anos, xuxu?</h2>
                <input type="number" name="age" min="18" id="age"> 

                <!-- Qual sua altura? -->
                <h2>Qual sua altura em metros?</h2>
                <input type="number" name="altura" min="0.5" id="altura"> 
            
                <!-- peso? -->
                <h2>Quantos kg pesa esse corpinho?</h2>
                <input type="number" name="peso" min="0.5" id="peso"> 
                
                <!-- Hipertensao? -->
                <h2>Tem hipertensão?</h2>
                <input class="red" type="radio" name="hipertenso" id="hipertenso_s" value="s"  >
                <label for="hipertenso_s">Sim</label>

                <input class="green" type="radio" name="hipertenso" id="hipertenso_n" value="n"  >
                <label  for="hipertenso_n" >Não!</label>
                
                <!-- heart disease? -->
                <h2>E esse coração? Tem doença cardíaca?</h2>
                <input class="red" type="radio" name="heart_disease" id="heart_disease_s" value="s"  >
                <label for="heart_disease_s">Sim</label>
                <input class="green" type="radio" name="heart_disease" id="heart_disease_n" value="n" >
                <label  for="heart_disease_n" >Não!</label>
                

                <!-- Casamento -->
                <h2>já foi casado?</h2>
                <input class="red" type="radio" name="casado" id="casado_s" value="s"  >
                <label for="casado_s">Sim</label>

                <input class="green" type="radio" name="casado" id="casado_n" value="n"  >
                <label  for="casado_n" >Não!</label>

                <!-- tipo de trabalho -->
                <h2>Em qual grupo seu trabalho mais se encaixa?</h2>
                <input class="green" type="radio" name="work_type" id="work_type_1" value="1"  >
                <label for="work_type_1">Iniciativa privada</label>
                <input class="green" type="radio" name="work_type" id="work_type_2" value="2"  >
                <label  for="work_type_2" >Autonômo</label>
                <input class="green" type="radio" name="work_type" id="work_type_3" value="3"  >
                <label  for="work_type_3" >Funcionário público</label>
                <input class="green" type="radio" name="work_type" id="work_type_4" value="4"  >
                <label  for="work_type_4" >Nunca trabalhei</label> 
                
                <!-- residencia -->
                <h2>Em que região você mora?</h2>
                <input class="green" type="radio" name="regiao_radio" id="regiao_radio_s" value="Urbana"  >
                <label for="regiao_radio_s">Urbana</label>
                <input class="green" type="radio" name="regiao_radio" id="regiao_radio_n" value="Rural"  >
                <label  for="regiao_radio_n" >Rural</label>
              
              

                só diabetes, docinho
                <br><br><br>

                <button onclick="predition()"> Sim, eu tenho coragem!</button>

          </div>


          

  <br>
  <!--
  <footer>
    <h1>Teste</h1>
  </footer>
  -->

<script>
  // script para realizar a predição
  function getId(id){ return document.getElementById(id)}
  
  function predition(){
    age = getId('age').value / 100;
    woman =  getId("radio_geneo_w").checked;
    casado = !getId("casado_s").checked;

    altura = getId('altura').value;
    peso = getId('peso').value;
    imc = peso / (altura * altura)
    imc = imc / 100
    hipertensao = getId("hipertenso_s").checked
    doenca_cardiaca = getId("heart_disease_s").checked
    
    work_type = [0,0,0,0];
    work_types =  [ ["work_type_1",0],["work_type_2",1],["work_type_3",2],["work_type_4",3]];
    for (i = 0; i < work_types.length; i ++)
      work_type[work_types[i][1]] = getId(work_types[i][0]).checked
      
    regiao_urbana = !getId("regiao_radio_s").checked
    //glucose = (getId("Trackbar").value - 55) / (300 - 55)
    glucose = (104.48275 - 55) / (300 - 55) // vamos usar a média
    
    //gender	age	hypertension	heart_disease	ever_married	Residence_type	avg_glucose_level	bmi	stroke	work_type_Private	work_type_Self-employed	work_type_Govt_job	work_type_Never_worked
    test_tensor = tf.tensor2d([[  
      woman, age, hipertensao, doenca_cardiaca, casado , regiao_urbana, glucose, imc, work_type[0],work_type[1],work_type[2],work_type[3], 0,0,0
    ]]);

    resultado = model_heart.predict(test_tensor);
    console.log("Genero: "+woman+"\n   Age:"+age+"\nHipertensao:"+hipertensao+"\ndoença cardiaca:    "+doenca_cardiaca+"\ncasado:    "+casado +"\n regiao urbana:    "+regiao_urbana+"\n glicose:   "+glucose+"\n imc:   "+imc+"\n  wt0:  "+work_type[0]+"   "+work_type[1]+"   "+work_type[2]+"   "+work_type[3]
    
    )
    
    console.log(model_heart.predict(test_tensor).print());
    alert( resultado.dataSync()[0] )
  }

</script>

</body>
</html>
